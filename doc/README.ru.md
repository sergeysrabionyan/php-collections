# PHP Коллекции

Библиотека для удобной работы с массивами данных различных структур с использованием функционального подхода. В основе лежат структуры данных, такие как: Список, Карта, Множество, Стек, Очередь. 

Для обхода и преобразования коллекций используется stream api (Stream), который обеспечивает более функциональный подход.

Читать на других языках: [English](../README.md)

## Установка

Установить и использовать библиотеку в собственном проекте можно использовав  менеджер зависимостей [Composer](https://getcomposer.org/)

```bash
composer require worksolutions/php-collections
``` 

## Пример использования
```php

use WS\Utils\Collections\CollectionFactory;
use WS\Utils\Collections\Functions\Predicates;

// Отобрать элементы по фильтру
CollectionFactory::from([1, 2, 3])
    ->stream()
    ->filter(Predicates::moreThan(1))
    ->getCollection(); // Collection [2, 3]

// Распечатать все файлы в директории
CollectionFactory::fromIterable(new DirectoryIterator(__DIR__))
    ->stream()
    ->each(static function (SplFileInfo $fileInfo) {
        echo $fileInfo->getFilename() . "\n";
    });

```

## Основные концепции

В основе использования библиотеки лежит последовательный подход обработки и преобразования данных. Создание некого конвейера преобразования, где можно последовательно выполнять некие шаги. Каждый шаг отвечает только за свой небольшой кусочек работы. В этом случае шаги можно переиспользовать так как они являются более наглядными.

Фундаментально библиотека состоит из нескольких частей, это: 

- [Структуры данных.](#Структуры-данных) Каждая имеет свою особенность, выраженную при помощи интерфейса и описания к нему, и реализацию. При этом реализации поведения структур данных могут быть разные.
- [Фабрика создания коллекции.](#Фабрика-создания-коллекции) Имеет множество статических методов для удобного создания коллекций.
- [Потоки обхода коллекций.](#Потоки-обхода-коллекций) Предназначен для обхода и преобразования коллекций, при этом каждое преобразование создает новый экземпляр коллекции.
- [Набор функций обхода и преобразования.](#Набор-функций-обхода-и-преобразования) Состоит из заранее подготовленных конструкторов функций для удобного использования в момент обхода. Можно создать использовать собственные функции более специфичные для вашей предметной области.

## Структуры данных

В основе библиотеки лежат самые популярные структуры данных которые являются самодостаточными для использования без каких-либо посторонних библиотек и классов. Все остальные части библиотеки основываются на эти структуры, в частности на интерфейс `Collection`. Все структуры данных коллекций содержат множество элементов с которыми можно проводить основные процедуры, такие как: обход, преобразование, агрегирования и т.д.

### Коллекция (Collection)

Основной базовый интерфейс коллекций. Все структуры данных кроме `карт (Map)` реализуют этот интерфейс, весь дополнительный функционал (Фабрики, Потоки обхода) используют данный интерфейс. Для поддержания универсальности в своих приложениях рекомендуется использовать именно интерфейс  `Collection`, но только в том случае если это не противоречит назначению использования структуры.

#### Методы интерфейса

- [*add* Добавление элемента в коллекцию](#добавление-элемента-в-коллекцию)
- [addAll](#addallelements-iterable-bool)
- [merge](#mergecollection-collection-bool)
- [clear](#clear-void)
- [remove](#removeelement-mixed-bool)
- [contains](#containceelement-mixed-bool)

##### Добавление элемента в коллекцию

```
add($element: mixed): bool;
```

Добавляет элемент в конец коллекции. Возвращает `true` в случае успешного ответа или `false` при неудаче.

```php

use WS\Utils\Collections\CollectionFactory;

$collection = CollectionFactory::from([1, 2]); // [1, 2]
$collection->add(10); // [1, 2] -> [1, 2, 10];

```
- ##### ```addAll($elements: iterable): bool;```

Добавляет множества элементов в конец коллекции. Возвращает `true` в случае успешного ответа или `false` при неудаче.

```php

use WS\Utils\Collections\CollectionFactory;

$collection = CollectionFactory::from([1, 2]); // [1, 2]
$collection->add([10, 11, 12]); // true
$collection->toArray(); // [1, 2] -> [1, 2, 10, 11, 12];

```

- ##### ```merge($collection: Collection): bool;```

Метод объединяет текущую коллекцию с переданной. Возвращает `true` в случае успешного ответа или `false` при неудаче.

```php

use WS\Utils\Collections\CollectionFactory;

$collection = CollectionFactory::from([1, 2]); // [1, 2]
$mergingCollection = CollectionFactory::from([11, 12]); // [11, 12]
$collection->merge($mergingCollection); // true
$collection->toArray(); // [1, 2, 10, 11, 12];

```
- ##### ```clear(): void;```

Удаление всех элементов коллекции.

```php

use WS\Utils\Collections\CollectionFactory;

$collection = CollectionFactory::from([1, 2]); // [1, 2]
$collection->clear(); // null
$collection->toArray(); // [];

```

- ##### ```remove($element: mixed): bool;```

Удаление конкретного элемента в коллекции. Метод возвращает признак удаления элемента. Если элемента не существовало, вернется `false`.

```php

use WS\Utils\Collections\CollectionFactory;

$collection = CollectionFactory::from([1, 2, 3]); // [1, 2, 3]
$collection->remove(2); // true
$collection->remove(4); // false
$collection->toArray(); // [1, 3];

```

- ##### ```contains($element: mixed): bool;```

Проверка наличия конкретного элемента в коллекции. Если элемента не существует, вернется `false`.

```php

use WS\Utils\Collections\CollectionFactory;

$collection = CollectionFactory::from([1, 2, 3]); // [1, 2, 3]
$collection->contains(2); // true
$collection->contains(4); // false

```


### Список (List)

### Карта (Map)

### Множество (Set)

### Очередь (Queue)

### Стек (Stack)

## Фабрика создания коллекции

### Потоки обхода коллекций